<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <script src="http://d3js.org/d3.v3.min.js"></script>
    </head>
    <body>
        <h1>Autonomous Vehicles</h1>
        <div id="svgCanvas"></div>

        <script type="text/javascript">
        
        /* CONSTANTS */

        width = 600.0;
        height = 600.0;
        
        companyWidth = width / 7.0;
        companyHeight = height / 7.0;
        companyColor = "#32CD32";

        startupRadius = width / 15.0;
        startupColor = "#4682B4";

        unit = "px"

         /* CANVAS SETUP */

        svg = d3.select("#svgCanvas")
                .append("svg")
                .attr("width", width  + unit)
                .attr("height", height + unit);
        // Add a rectangle so we can always see our canvas size
        svg.append("rect")
            .attr("width", "100%")
            .attr("height", "100%")
            .attr("fill", "#faebd7");


        companies = ['Waymo', 'Uber', 'Apple', 'Tesla']
        for (i = 0; i < companies.length; i++) {
            addCompanyBlock(companies[i]);
        }
        svg.selectAll('g.company')
        .attr("transform", function(d, i) {
          return defaultTranslationForCompany(i)
        });

        startups = ['Otto', 'Argo AI', 'Faraday Futures', 'Clinsense']
        for (i = 0; i < startups.length; i++) {
            addStartupBlock(startups[i]);
        }
        svg.selectAll('g.startup')
        // .transition()
        // .delay(1500)
        // .duration(2000)
        .attr("transform", function(d, i) {
          return defaultTranslationForStartup(i)
        });

        /* ANIMATIONS */

        companies.push("Glusha")
        addCompanyBlock("Glusha");
        svg.selectAll('g.company')
        .transition()
        .delay(1500)
        .duration(2000)
        .attr("transform", function(d, i) {
          return defaultTranslationForCompany(i)
        });


        defaultTranslationForStartup
        // startup.select("circle")
        //         .attr("cx", startupRadius)
        //         .attr("cy", startupRadius);
        /*                  
         * STARTUP METHODS
         */

         function addStartupBlock(name) {
          g = svg.append("g")
              .attr("id", name)
              .attr("class", "startup");
          g.append("circle")
             .attr("fill", startupColor)
             .attr("r", startupRadius + unit)
          g.append("text")
            .style("text-anchor", "middle")
            .style("alignment-baseline", "middle")
            .text(name);
          return g;
         }

         function defaultTranslationForStartup(i) {
            margin = (width - (width * (startups.length - 1))/startups.length) / 2;
            x = (width * i)/startups.length + margin;
            y = 4 * height/5 -startupRadius/2; // Put it 4/5th of the way down
            return ("translate(" + x + "," + y + ")");
         }


        /*                  
         * COMPANY METHODS
         */

        function addCompanyBlock(name) {
          g = svg.append("g")
              .attr("id", name)
              .attr("class", "company");
          g.append("rect")
              .attr("fill", companyColor)
              .attr("height", companyHeight + unit)
              .attr("width", companyWidth + unit);
          g.append("text")
              .attr("y", companyHeight/2 + unit)
              .attr("x", companyWidth/2 + unit)
              .style("text-anchor", "middle")
              .style("alignment-baseline", "middle")
              .text(name);

          return g;
        };

        function defaultTranslationForCompany(i) {
            margin = (width - (width * (companies.length - 1))/companies.length - companyWidth) / 2; // Used to center
            x = (width * i)/companies.length + margin;
            y = height/5 -companyHeight/2; // Put it 1/5th of the way up
            return ("translate(" + x + "," + y + ")");
        }

        </script>
    </body>
</html>  