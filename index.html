<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <link rel="stylesheet" href="stylefuture.css">

        <!-- BOOTSTRAP STUFF -->
        <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
        <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
        
        <script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
        <script src="https://npmcdn.com/bootstrap@4.0.0-alpha.5/dist/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

        <!-- D3 -->
        <script src="http://d3js.org/d3.v4.min.js"></script>

    </head>

    <style>

    .topic-row {
        width: 100vw;
        height: 100vh;

        /*
         *  PRESENT SECTIION STYLING
         */
    }
    #title-row {
        background-color: red;
    }

    #past-row {
        background-color: green;
    }

    #present-row {
        background-color: orange;
    }

    #future-row {
        background-color: pink;
    }
/*        p, li {
            font-size: 14px;
        }
        .present-info {
            margin-left:20px;
            margin-top:20px;
            padding:20px;
        }
        #year-info-cont {
          height:325px;
          background-color: rgba(70, 130, 180, .3);
        }
        #company-info-cont {
          height:400px;
            background-color: rgba(50, 205, 50, .3);
        }
        .svg-container {
            width:700px;
            z-index:1;
        }*/




    </style>
    <body>

    <div class="container-fluid">

        <div class = "row topic-row" id="future-row">
          <div class="row">
            <div class="col">
                <h2>
                    AUTONOMOUS VEHICLES: THE FUTURE
                </h2>
            </div>
          </div>
          
          <div class="row">
            <div class="col-4">
              <table class="table table-condensed">
                <thead>
                  <tr>
                    <th>Level of Autonomy</th>
                    <th class = "des">Description of </br> Autonomy Level</th>
                    <th>Vehicle Example</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">5</th>
                    <td class = "des"><b>Most autonomy.</b> The vehicle performs as well as a human driver in any type of scenario.</td>
                    <td>Volkswagen Sedric</td>
                  </tr>
                  <tr>
                    <th scope="row">4</th>
                    <td class = "des">The vehicle controls "all safety-critical driving functions and monitors roadway conditions for an entire trip." Yet, the driver is still necessary in scenarios that are outside of the "operational design domain (ODD)."</td>
                    <td>Ford Fusion Hybrid</td>
                  </tr>
                  <tr>
                    <th scope="row">3</th>
                    <td class = "des"> <b>Middle autonomy.</b> The driver is necessary, but in specific traffic or environmental conditions all "safety-critical functions" are controlled by the vehicle. The driver may need to intervene depending on the situation, but does not have to monitor as much as in the other levels. Many companies are considering skipping level 3 as it requires people to go from a state of inattentiveness to one of alertness very quickly.</td>
                    <td>Tesla Model S</td>
                  </tr>
                    <th scope="row">2</th>
                    <td class = "des">At least one driver assistance system, like steering and acceleration/deceleration is automated. The vehicle can gauge when to engage these systems based on understanding the driving environment. Automated processes also include cruise control and lane-centering. While not actively using hands or feet, the driver must always pay attention and be ready to take control of the vehicle at any time.</td>
                    <td>Mercedes-Benz E-Class</td>
                  </tr>                 
                  <tr>
                    <th scope="row">1</th>
                    <td class = "des"> <b>Least autonomy.</b> The driver is still in control of most of the driving, but functions like steering or accelerating are controlled by the car.</td>
                    <td>Audi A7</td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div class="col-1">
            </div>

            <div class="col-7">

              <div class = "row">
                <div id="scatterplot">
                </div>
              </div>

              <div class = "row">

                <div class="col">
                  <div id="legendbox">
                 </div>
                </div>

              </div>
            </div>

          </div>
        </div>

        <div class="row topic-row" id="title-row">

        </div>

        <div class = "row topic-row" id="past-row">
        Good afternoon, Marti!

        </div>

        <div class = "row topic-row" id="present-row">
        Good evening, Marti!
        </div>


    </div>

    </body>
    
    <script>
    var margin = {top: 40, right: 90, bottom: 50, left: 50},
        width = 960 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    /*
     * value accessor - returns the value to encode for a given data object.
     * scale - maps value to a visual display encoding, such as a pixel position.
     * map function - maps from data value to display value
     * axis - sets up axis
     */ 

    // setup x 
    var xValue = function(d) { return d.Year;}, // data -> value
        xScale = d3.scaleLinear().range([0, width]), // value -> display
        xMap = function(d) { return xScale(xValue(d));}, // data -> display
        xAxis = d3.axisBottom().scale(xScale).ticks(16)
                .tickFormat(d3.format("d")).tickSizeOuter(0);

    // setup y

    var ticks = [0,1,2,3,4,5];
    var tickLabels = ["N/A",1,2,3,4,5];

    var yValue = function(d) { return d["Level"];}, // data -> value
        yScale = d3.scaleLinear().range([height, 0]), // value -> display
        yMap = function(d) { return yScale(yValue(d));}, // data -> display
        yAxis = d3.axisLeft().scale(yScale).tickValues(ticks)
                .tickFormat(function(d,i){ return tickLabels[i] }).tickSizeOuter(0);


    // setup fill color
    // var cValue = function(d) { return d.bl;};
    // color = d3.scaleOrdinal(d3.schemeCategory10);

    // add the graph canvas to the body of the webpage
    var svg = d3.select("#scatterplot").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


    // add the tooltip area to the webpage
    var tooltip = d3.select("body").append("div")
        .attr("class", "tooltip")
        .style("opacity", 0);

    // load data
    d3.csv("future/ship_dates.csv", function(error, data) {

      // change string (from CSV) into number format
      data.forEach(function(d) {
        d.Year = +d.Year;
        d["Level"] = +d["Level"];
      });

      // don't want dots overlapping axis, so add in buffer to data domain
      xScale.domain([d3.min(data, xValue)-0.2, d3.max(data, xValue)+0.2]);
      yScale.domain([d3.min(data, yValue)-0.5, d3.max(data, yValue)+0.2]);

      // x-axis

      xAxisTranslateX = width/2.0;
      xAxisTranslateY = margin.bottom;
      svg.append("g")
          .attr("class", "x-axis")
          .attr("transform", "translate(0," + height + ")")
          .call(xAxis)
        .append("text")
          .attr("class", "x-label")
          .attr("transform", "translate(" + xAxisTranslateX + "," + xAxisTranslateY + ")")
          .style("text-anchor", "end")
          .text("Expected Ship Year");

      // y-axis

      yAxisTranslateX = -margin.left;
      yAxisTranslateY = height/2.0 - 25.0; // It looks gross in the middle so we moved it up a bit
      svg.append("g")
          .attr("class", "y-axis")
          .call(yAxis)
        .append("text")
          .attr("class", "y-label")
          .attr("transform", "translate(" + yAxisTranslateX + "," + yAxisTranslateY + ")rotate(-90)")
          .attr("y", 6)
          .attr("dy", ".71em")
          .style("text-anchor", "end")
          .text("Level of Autonomy");

        // add rectangle
        svg.append("rect")
            .attr("id", "NANs")
            .attr("x", 0)
            .attr("y", height*(5/6))
            .attr("width", width)
            .attr("height", height/6)
            .attr("fill", "red")
            .attr("fill-opacity", .4);


      // draw dots
      svg.selectAll(".dot")
          .data(data)
        .enter().append("circle")
          .attr("class", "dot")
          .attr("r", 5)
          .attr("cx", xMap)
          .attr("cy", yMap)
          // .style("fill", function(d) { return color(cValue(d));}) 
          .style("fill", "blue")
          .style("opacity", .6)
          .style("stroke", "black")
          .on("mouseover", function(d) {
              tooltip.transition()
                   .duration(200)
                   .style("opacity", .9);
              tooltip.html(d["Company"])
                   .style("left", (d3.event.pageX + 5) + "px")
                   .style("top", (d3.event.pageY - 28) + "px")
                   .style("font-size", "12px");
                      // add box to the webpage
            var box = d3.select("#legendbox").append("div")
                .attr("id", "infobox")
                .style("margin-left", (margin.left-15) + "px")
                .style("margin-right", (margin.right-15) + "px")
                .style("opacity", 100);

              box.append("h4").text(d["Company"]);
              ul = box.append("ul");
              var bullet_points = d["Comments"].split("; ");
              for (i in bullet_points) {
                point = bullet_points[i];
                ul.append("li")
                    .text(point)
                    .style("font-size", "16px");
              }


          })
          .on("mouseout", function(d) {
              tooltip.transition()
                   .duration(500)
                   .style("opacity", 0);
              d3.select("#infobox").node().remove();
          });

        });

    </script>
</html>

    


















